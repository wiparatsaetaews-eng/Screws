<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ตรวจเช็คน็อตก่อนเริ่มงาน</title>

<style>
body{
  font-family: Arial, sans-serif;
  max-width: 480px;
  margin: auto;
  padding: 20px;
}

h2{
  text-align:center;
}

.checklist{
  background:#f4f6f8;
  padding:15px;
  border-radius:10px;
}

.checklist label{
  display:block;
  margin-bottom:10px;
  font-size:16px;
}

input[type="text"], input[type="datetime-local"]{
  width:100%;
  padding:8px;
  margin-top:8px;
  margin-bottom:12px;
}

button{
  width:100%;
  padding:12px;
  font-size:16px;
  border:none;
  border-radius:8px;
  background:#2e7d32;
  color:white;
}

button:hover{
  background:#1b5e20;
}

#result{
  margin-top:15px;
  font-weight:bold;
}
</style>
</head>

<body>

<h2>✅ ตรวจเช็คน็อตก่อนเริ่มงาน</h2>

<div class="checklist">
  <label><input type="checkbox"> (A) น็อตยึด Hopper กับแท่นเครื่อง</label>
  <label><input type="checkbox"> (B) น็อตรอบ Hopper ซ้าย-ขวา</label>
  <label><input type="checkbox"> (C) น็อตยึดท่อส่ง Bulk</label>
  <label><input type="checkbox"> (D) น็อตบริเวณปากถัง Bulk</label>
</div>

<label>ผู้ตรวจสอบ</label>
<input type="text" id="inspector" placeholder="กรอกชื่อผู้ตรวจ">

<label>วัน / เวลา</label>
<input type="datetime-local" id="date">

<button onclick="sendData()">บันทึกการตรวจสอบ</button>

<p id="result"></p>

<script>
function sendData(){

  const url = "https://script.google.com/macros/s/AKfycbzUGOrUviuHHcZKvt2yVbQT1Za9bVIG3gwmMdySU4MEbqJu8ZCZs95siP5nW9Ecr7Kc/exec";

  let checks = document.querySelectorAll('input[type="checkbox"]');
  let name = document.getElementById("inspector").value;

  if(name === ""){
    alert("กรุณากรอกชื่อผู้ตรวจ");
    return;
  }

  let allChecked = true;
  checks.forEach(c => { if(!c.checked) allChecked = false; });

  if(!allChecked){
    document.getElementById("result").innerHTML =
    "⚠️ ตรวจไม่ครบ! กรุณาตรวจน็อตให้ครบก่อนเริ่มเครื่อง";
    return;
  }

  const data = {
    inspector: name,
    A: checks[0].checked ? "ผ่าน" : "ไม่ผ่าน",
    B: checks[1].checked ? "ผ่าน" : "ไม่ผ่าน",
    C: checks[2].checked ? "ผ่าน" : "ไม่ผ่าน",
    D: checks[3].checked ? "ผ่าน" : "ไม่ผ่าน"
  };

  fetch(url,{
    method:"POST",
    body: JSON.stringify(data)
  })
  .then(()=>{
    document.getElementById("result").innerHTML =
    "✅ บันทึกข้อมูลเรียบร้อย สามารถเริ่มเครื่องได้";
  })
  .catch(()=>{
    alert("❌ ส่งข้อมูลไม่สำเร็จ กรุณาลองใหม่");
  });

}
</script>

</body>
</html>
